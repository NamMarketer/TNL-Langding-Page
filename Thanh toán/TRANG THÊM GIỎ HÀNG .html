

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giỏ hàng - TNL</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="site-header">
        <div class="container">
           <a href="index.html" class="logo">TNL</a>
           <nav>
               </nav>
            <div class="header-icons">
               <a href="#" aria-label="Tìm kiếm"><i class="fas fa-search"></i></a>
                <a href="#" aria-label="Yêu thích"><i class="far fa-heart"></i></a>
                <a href="#" aria-label="Tài khoản"><i class="far fa-user"></i></a>
                <a href="cart.html" aria-label="Giỏ hàng"><i class="fas fa-shopping-bag"></i> <span class="cart-count">1</span></a>
           </div>
       </div>
   </header>


   <div class="container cart-page-container">
       <div class="cart-items-list">
           <h2>GIỎ HÀNG (<span id="cart-item-count">1</span> SẢN PHẨM)</h2>

           <ul class="cart-items">
               <li class="cart-item" data-id="product1">
                   <div class="cart-item-image">
                       <img src="product1.jpg" alt="Vòng Bạc Pandora"> </div>
                   <div class="cart-item-details">
                       <h3>Vòng Bạc Pandora Khoá Trái Tim Và Tên Trong Suốt</h3>
                       <p class="item-attributes">Chất liệu: Bạc | Kích thước: 18</p>
                       <div class="item-actions-mobile"> <button class="item-action-btn remove-item-btn" title="Xóa"><i class="fas fa-trash-alt"></i></button>
                           <button class="item-action-btn" title="Yêu thích"><i class="far fa-heart"></i></button>
                       </div>
                   </div>
                   <div class="cart-item-quantity">
                        <span class="item-price-mobile">3,590,000₫</span> <div class="quantity-selector">
                           <button type="button" class="quantity-btn minus-btn" aria-label="Giảm số lượng">-</button>
                           <input type="number" class="quantity-input" value="1" min="1" aria-label="Số lượng">
                           <button type="button" class="quantity-btn plus-btn" aria-label="Tăng số lượng">+</button>
                       </div>
                   </div>
                   <div class="cart-item-price">
                       <span>3,590,000₫</span>
                   </div>
                   <div class="cart-item-actions">
                        <button class="item-action-btn remove-item-btn" title="Xóa"><i class="fas fa-trash-alt"></i></button>
                        <button class="item-action-btn" title="Yêu thích"><i class="far fa-heart"></i></button>
                        </div>
               </li>
               </ul>
       </div>

       <div class="order-summary cart-summary"> <section class="checkout-section">
               <h2>ĐƠN HÀNG</h2>

               <div class="promo-code-section">
                   <label for="cart-promo-code">Mã giảm giá:</label>
                   <div class="promo-input-group">
                       <input type="text" id="cart-promo-code" name="promo_code" placeholder="Nhập mã giảm giá">
                       <button type="button" class="apply-promo-button">ÁP DỤNG</button>
                   </div>
               </div>

               <div class="gift-wrap-section">
                    <label for="gift-wrap">Gói quà tặng:</label>
                    <button type="button" class="add-gift-wrap-button">Thêm</button>
                    </div>

                <div class="invoice-option">
                    <label class="checkbox-label">
                        <input type="checkbox" name="invoice_required">
                        <span class="checkbox-custom"></span>
                        Xuất hoá đơn cho đơn hàng
                    </label>
                </div>

                <div class="order-notes-section">
                    <label for="cart-notes">Ghi chú đơn hàng:</label>
                    <textarea id="cart-notes" name="notes" rows="3" placeholder="Thêm ghi chú..."></textarea>
                </div>


               <div class="cart-subtotal">
                   <span>Tạm tính:</span>
                   <span class="subtotal-amount">3,590,000₫</span>
               </div>

               <p class="cart-terms">
                    <i class="fas fa-info-circle"></i> Bấm nút "Thanh toán" đồng nghĩa với việc bạn đồng ý tuân theo <a href="/dieu-khoan-dich-vu" target="_blank">Điều khoản và điều kiện</a> giao dịch của TNL Việt Nam.
                </p>

               <a href="checkout.html" class="checkout-button"> THANH TOÁN
               </a>
           </section>
       </div>
   </div>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 TNL. All rights reserved.</p>
        </div>
    </footer>

   <script src="script.js"></script>
    <script>
       // --- JavaScript cho trang Giỏ hàng ---

       document.addEventListener('DOMContentLoaded', () => {
           const cartItemsContainer = document.querySelector('.cart-items');

           // Hàm cập nhật tổng tiền và số lượng item
           function updateCartSummary() {
               let subtotal = 0;
               let itemCount = 0;
               const items = cartItemsContainer.querySelectorAll('.cart-item');

               items.forEach(item => {
                   const priceText = item.querySelector('.cart-item-price span').textContent;
                   const price = parseFloat(priceText.replace(/[^0-9]/g, '')); // Lấy số từ giá
                   const quantity = parseInt(item.querySelector('.quantity-input').value);

                   if (!isNaN(price) && !isNaN(quantity)) {
                       subtotal += price * quantity;
                       itemCount += quantity; // Hoặc itemCount = items.length nếu đếm theo dòng sản phẩm
                   }
               });

               // Cập nhật hiển thị
               const subtotalElement = document.querySelector('.subtotal-amount');
               if (subtotalElement) {
                   subtotalElement.textContent = subtotal.toLocaleString('vi-VN') + '₫';
               }

               const itemCountElement = document.getElementById('cart-item-count');
               const headerCartCount = document.querySelector('.header-icons .cart-count');
                if (itemCountElement) {
                   // itemCountElement.textContent = items.length; // Đếm theo dòng sản phẩm
                   itemCountElement.textContent = itemCount; // Đếm theo tổng số lượng
               }
                if (headerCartCount) {
                   // headerCartCount.textContent = items.length;
                    headerCartCount.textContent = itemCount;
               }

                // Hiển thị/ẩn giỏ hàng trống (tùy chọn)
                const cartContainer = document.querySelector('.cart-page-container');
                if (items.length === 0) {
                   cartContainer.innerHTML = '<div class="cart-empty"><h2>GIỎ HÀNG CỦA BẠN ĐANG TRỐNG</h2><p>Hãy thêm sản phẩm vào giỏ hàng nhé!</p><a href="/" class="button-primary">Tiếp tục mua sắm</a></div>'; // '/' là trang chủ
                }
           }


           // Xử lý nút +/- và input số lượng
           cartItemsContainer.addEventListener('click', (event) => {
               const target = event.target;
               const cartItem = target.closest('.cart-item');
               if (!cartItem) return;

               const quantityInput = cartItem.querySelector('.quantity-input');
               let currentValue = parseInt(quantityInput.value);

               if (target.classList.contains('plus-btn')) {
                   currentValue++;
                   quantityInput.value = currentValue;
                   updateCartSummary();
               } else if (target.classList.contains('minus-btn')) {
                   if (currentValue > 1) {
                       currentValue--;
                       quantityInput.value = currentValue;
                       updateCartSummary();
                   } else {
                       // Nếu muốn xóa khi số lượng về 0
                       // if (confirm('Bạn có muốn xóa sản phẩm này khỏi giỏ hàng?')) {
                       //     cartItem.remove();
                       //     updateCartSummary();
                       // }
                   }
               }
           });

            // Xử lý thay đổi trực tiếp input số lượng
            cartItemsContainer.addEventListener('change', (event) => {
                if (event.target.classList.contains('quantity-input')) {
                     let value = parseInt(event.target.value);
                     if (isNaN(value) || value < 1) {
                         event.target.value = 1; // Set lại giá trị nhỏ nhất là 1
                     }
                     updateCartSummary();
                }
            });


           // Xử lý nút xóa item
           cartItemsContainer.addEventListener('click', (event) => {
               if (event.target.closest('.remove-item-btn')) {
                   const cartItem = event.target.closest('.cart-item');
                   if (cartItem && confirm('Bạn có chắc chắn muốn xóa sản phẩm này khỏi giỏ hàng?')) {
                       cartItem.remove();
                       updateCartSummary();
                       // Thêm logic gọi API xóa sản phẩm ở backend nếu cần
                   }
               }
           });


            // Placeholder cho các nút khác
            const applyPromoButtonCart = document.querySelector('#cart-promo-code + .apply-promo-button');
            if (applyPromoButtonCart) {
               applyPromoButtonCart.addEventListener('click', function() {
                    alert('Placeholder: Xử lý áp dụng mã giảm giá.');
               });
            }
            const addGiftWrapButton = document.querySelector('.add-gift-wrap-button');
             if (addGiftWrapButton) {
               addGiftWrapButton.addEventListener('click', function() {
                    alert('Placeholder: Xử lý thêm gói quà.');
                });
            }

           // Cập nhật tổng tiền lần đầu khi tải trang
           updateCartSummary();
       });


    </script>
</body>
</html>